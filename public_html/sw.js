const CACHE_NAME='MerchantSlate';const urlsToCache=["/","/index.html","/app.json","/about"];self.addEventListener('install',e=>e.waitUntil(caches.open(CACHE_NAME).then(c=>c.addAll(urlsToCache))));self.addEventListener('activate',e=>e.waitUntil(caches.keys().then(n=>Promise.all(n.map(n=>n!==CACHE_NAME?caches.delete(n):null))).then(()=>self.clients.claim())));self.addEventListener('fetch',e=>e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request).catch(()=>caches.match('/index.html')))));self.addEventListener('notificationclick',e=>{e.notification.close();const u=new URL('/',self.location.origin).href;e.waitUntil(clients.matchAll({type:'window',includeUncontrolled:true}).then(c=>{for(const t of c)if(t.url===u&&'focus' in t)return t.focus();if(clients.openWindow)return clients.openWindow(u);}));});self.addEventListener('notificationclose',e=>console.log('Notification closed:',e.notification));self.addEventListener('push',e=>{let d={"title":"MerchantSlate Notification","body":"You have a new notification!"};if(e.data)d=e.data.json();const o={body:d.body,icon:'https://merchantslate.com/assets/images/app_icon.png',badge:'https://merchantslate.com/assets/images/app_icon.png',data:{url:new URL('/',self.location.origin).href}};e.waitUntil(self.registration.showNotification(d.title,o));});